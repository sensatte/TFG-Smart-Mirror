#:kivy 1.0
#:set buttonsSize (.2, .25)
#:set cloudImage "https://asxornvikq.cloudimg.io/v7/"
#:set roundedCorners "?radius=32&force_format=png"

#TODO AÃ‘ADIR RESTO DE WIDGETS

<SpotifyWidget2>:
    size_hint:(.2, .1)
    pos: 0,5
    # canvas.before:
    #     Color:
    #         rgba: 0.2,0.5,0.4,1
    #     Rectangle:
    #         pos: 0, 0
    #         size: self.size

    # Label:
    #     id: deviceId
    #     text: root.deviceId[-4:] if root.deviceId != None else ""
    #     pos_hint: {"center_x": .5, "center_y": .9}
    #     #TODO WHY WONT POS_HINT WORK HERE

    ImageButton:
        id: startPauseButton
        disabled: root.relaxing
        color: [.3, .3, .3, 1] if self.disabled  else [1, 1, 1, 1]
        keep_ratio: False
        allow_stretch: True
        source: "images/icons/spotify/boton-de-play.png" if (root.paused) else "images/icons/spotify/boton-de-pausa.png"
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: buttonsSize
        on_press: root.relaxWithThePresses()
        on_press: root.wrapper.pauseResume(root.deviceId)
        on_press: root.pushedButtonAnim(self)
        on_press: root.paused = not root.paused
        on_press: print(self.source)
        # canvas.before:
        #     Color:
        #         rgba: 0.2,0.5,0.4,1
        #     Rectangle:
        #         pos: self.pos
        #         size: self.size

    ImageButton:
        id: nextButton
        disabled: root.relaxing
        color: [.3, .3, .3, 1] if self.disabled  else [1, 1, 1, 1]
        keep_ratio: False
        allow_stretch: True
        source: "images/icons/spotify/siguiente.png"
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: buttonsSize
        on_press: root.relaxWithThePresses()
        on_press: root.wrapper.next(root.deviceId)
        on_press: root.pushedButtonAnim(self)
        on_press: root.paused = False
        # canvas.before:
        #     Color:
        #         rgba: 0.2,0.5,0.4,1
        #     Rectangle:
        #         pos: self.pos
        #         size: self.size

    ImageButton:
        id: previousButton
        disabled: root.relaxing
        color: [.3, .3, .3, 1] if self.disabled  else [1, 1, 1, 1]
        keep_ratio: False
        allow_stretch: True
        source: "images/icons/spotify/anterior.png"
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: buttonsSize
        on_press: root.relaxWithThePresses()
        on_press: root.wrapper.previous(root.deviceId)
        on_press: root.pushedButtonAnim(self)
        on_press: root.paused = False
        # canvas.before:
        #     Color:
        #         rgba: 0.2,0.5,0.4,1
        #     Rectangle:
        #         pos: self.pos
        #         size: self.size

    ImageButton:
        id: volDown
        disabled: root.relaxing
        color: [.3, .3, .3, 1] if self.disabled  else [1, 1, 1, 1]
        keep_ratio: False
        allow_stretch: True
        source: "images/icons/spotify/control-del-volumen-menos.png"
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: buttonsSize
        on_press: root.relaxWithThePresses()
        on_press: print("volDown")
        on_press: root.pushedButtonAnim(self)
        on_press: root.volDown()
        # canvas.before:
        #     Color:
        #         rgba: 0.2,0.5,0.4,1
        #     Rectangle:
        #         pos: self.pos
        #         size: self.size

    ImageButton:
        id: volUp
        disabled: root.relaxing
        color: [.3, .3, .3, 1] if self.disabled  else [1, 1, 1, 1]
        keep_ratio: False
        allow_stretch: True
        source: "images/icons/spotify/control-del-volumen-mas.png"
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: buttonsSize
        on_press: root.relaxWithThePresses()
        on_press: print("volUp")
        on_press: root.pushedButtonAnim(self)
        on_press: root.volUp()
        # canvas.before:
        #     Color:
        #         rgba: 0.2,0.5,0.4,1
        #     Rectangle:
        #         pos: self.pos
        #         size: self.size

    AsyncImageButton:
        id: songImage
        nocache: True
        source: cloudImage+root.songImageUrl+roundedCorners if root.songImageUrl != "" else "images/menu/Spotify_bonico.png"
        size_hint: .7, .7
        pos_hint: {"center_x": .5, "center_y": .5}
        allow_stretch: True
        keep_ratio: True
        on_press: root.collapsed = not root.collapsed
        canvas.before:
            PushMatrix
            Rotate:
                angle: root.songImageAngle
                axis: 0, 0, 1
                origin: self.center
        canvas.after:
            PopMatrix

    

    Label:
        id: songNameLabel
        text: root.songName

    